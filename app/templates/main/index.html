{% extends "main/base.html" %}

{% block content %}

    <!-- Authenticated users -->
    {% if current_user.is_authenticated %}
            
    <h1>Hi, {{ current_user.name }}!</h1>

    <!-- Chart JS Bar Chart -->
    <div class="row">
        <div class="col s12 m6 l6">
            <div class="card-panel">
                <canvas id="barChart" width="200" height="100"></canvas>
            </div>
        </div>

    <script>
    var ctx = document.getElementById('barChart').getContext('2d');
    var barChart = new Chart(ctx, {
        type: 'bar',
        data: {
            labels: [{% for item in labels %}
                        "{{item}}",
                    {% endfor %}],
            datasets: [{
                label: 'Spend',
                data:   [{% for item in values %}
                            "{{item}}",
                        {% endfor %}],
                backgroundColor: [
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)',
                    'rgba(255, 99, 132, 0.2)'
                ],
                borderColor: [
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)',
                    'rgba(255, 99, 132, 1)'
                ],
                borderWidth: 1
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
    </script>

    <!-- Chart JS line chart -->
   
        <div class="col s12 m6 l6">
            <div class="card-panel">
                <canvas id="lineChart" width="200" height="100"></canvas>
            </div>
        </div>
    </div>

    <script>
    var ctx = document.getElementById('lineChart').getContext('2d');
    var lineChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: [{% for item in labels %}
                        "{{item}}",
                    {% endfor %}],
            datasets: [{
                label: 'Spend',
                data:   [{% for item in values %}
                            "{{item}}",
                        {% endfor %}],
                fill: true,
                lineTension: 0.1,
                backgroundColor: "rgba(75,192,192,0.4)",
                borderColor: "rgba(75,192,192,1)",
                borderCapStyle: 'butt',
                borderDash: [],
                borderDashOffset: 0.0,
                borderJoinStyle: 'miter',
                pointBorderColor: "rgba(75,192,192,1)",
                pointBackgroundColor: "#fff",
                pointBorderWidth: 1,
                pointHoverRadius: 5,
                pointHoverBackgroundColor: "rgba(75,192,192,1)",
                pointHoverBorderColor: "rgba(220,220,220,1)",
                pointHoverBorderWidth: 2,
                pointRadius: 1,
                pointHitRadius: 10,
                spanGaps: false
            }]
        },
        options: {
            scales: {
                yAxes: [{
                    ticks: {
                        beginAtZero: true
                    }
                }]
            }
        }
    });
    </script>

    <!-- Cloud function data -->
    {% if data %}
    <div class="row">
        <div class="col s12 m8">
            <div class="card-panel">
                <table class="striped">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Spend</th>
                            <th>Clicks</th>
                            <th>Impressions</th>
                            <th>Conversions</th>
                        </tr>
                    </thead>
                    <tbody>

                    {% for row in data %}

                        <tr>
                            <td>{{ row['date'] }}</td>
                            <td>{{ "${:,.2f}".format(row['spend']|float) }}</td>
                            <td>{{ "{:,}".format(row['impressions']|int) }}</td>
                            <td>{{ "{:,}".format(row['clicks']|int) }}</td>
                            <td>{{ "{:,}".format(row['conversions']|int) }}</td>
                        </tr>

                    {% endfor %}

                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- Unauthenticated users -->
    {% else %}
    <div class="section">
        <div class="row center">
            <div class="col s12 m10 offset-m1">
                <h1 class="header">FireFlask</h1>
            </div>
            <div class="col s12 m8 offset-m2">
                <h4 class="light">Python Flask apps with Materalize CSS powered by a Firebase backend.</h4>
            </div>
        </div>
        <div class="row center">
            <div class="col s12 m8 offset-m2">
                <a href="{{ url_for('auth.sign_up') }}" class="waves-effect waves-light btn-large">SIGN UP</a>
            </div>
        </div>
    </div>
    <br>
    <div class="divider"></div>
    <br>
    <div class="section">
        <div class="row">
            <div class="col s12 m4">
                <div class="center promo">
                    <i class="large material-icons red-text">build</i>
                    <p class="promo-caption">Python Flask</p>
                    <p class="light center">Write business logic in Python with with lightweight Flask framework. Great for taking scripts out of jupyter notebooks and making them into user-friendly applications.</p>
                </div>
            </div>
    
            <div class="col s12 m4">
                <div class="center promo">
                    <i class="large material-icons red-text">photo_filter</i>
                    <p class="promo-caption">Materalize CSS</p>
                    <p class="light center">Utilize elements and principles of Google's Material Design with a modern CSS framework that incorporates components and animations that provide more feedback to users.</p>
                </div>
            </div>
    
            <div class="col s12 m4">
                <div class="center promo">
                    <i class="large material-icons red-text">storage</i>
                    <p class="promo-caption">Firebase backend</p>
                    <p class="light center">Forget about maintaining databases, writing SQL or worrying about how to scale your infrastructure. Google Firebase's serverless, NoSQL architecture takes care of everything for you.</p>
                </div>
            </div>
        </div>
    </div>
    <div class="divider"></div>
    <br>
    <div class="row center">
        <div class="col s12 m8 offset-m2">
            <div class="commit">
                Check out the project on Github:
                <a href="https://github.com/mjt145/FireFlask/tree/master">mjt145/FireFlask/tree/master</a>
            </div>
        </div>
    </div>
    <div class="divider"></div>
    <div class="section">
        <div id="team" class="section">
            <h3 class="header">Meet the Author</h3>
            <p>Who created FireFlask? Oh and by 'create', we mean 'hack together from multiple tutorials'.</p>
            <br>
            <div class="row">
                <div class="col s12 m3 center-on-small-only">
                    <div class="image-container">
                    <img src="{{ url_for('static', filename='img/mike.jpg') }}" class="circle responsive-img">
                </div>
                </div>
                <div class="col s12 m9">
                    <h4>Michael Taylor</h4>
                    <p>Is a marketer who learned to code. Co-founder of Ladder.io and Saxifrage.xyz, 
                        he has 10 years experience in growth marketing and has been coding in evenings 
                        and weekends for the past 5. He created FireFlask to make it easy to take his 
                        scripts out of Jupyter Notebooks and stand them up as web applications, without 
                        having to mess around with SQL, database migrations or scaling infrastructure.</p>
                </div>
            </div>
        </div>
    </div>
    <div class="divider"></div>      
    
    {% endif %}
{% endblock %}